const crypto = require('crypto');

const SALT_LEN = 16;

const util = {
  getSalt(len){
    return crypto.randomBytes(len).toString('hex').slice(0,len);
  },
  hash({password, salt = null}){
    salt = salt || util.getSalt(SALT_LEN);
    const hash = crypto.createHmac('sha512', salt);
    hash.update(password);
    return {
      hash:hash.digest('hex'),
      salt
    }
  },
  check({password, hash, salt}){
    return hash == util.hash({password, salt}).hash;
  }
}


module.exports = util;
