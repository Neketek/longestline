const jwt = require('jsonwebtoken');


const JWT_SECRET_KEY = process.env.JWT_SECRET_KEY;
if (JWT_SECRET_KEY === undefined){
  throw Error("Can't start without JWT_SECRET_KEY!");
}

const util = {
  
  async createUserAccessToken(user){
    return jwt.sign({id:user.id}, JWT_SECRET_KEY);
  },
  async verifyUserAccessToken(token){
    return jwt.verify(token, JWT_SECRET_KEY);
  }

}

module.exports = util;
