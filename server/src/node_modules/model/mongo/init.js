module.exports = async function(client){

  const conn = await client.connect();
  let db = await client.db('longestline');

  await db.createCollection('users', {
    validator:{
      $jsonSchema:{
        bsonType:"object",
        required:[
          "email",
          "password.hash",
          "password.salt"
        ],
        properties:{
          email:{
            bsonType:"string",
            description:"Email is required"
          },
          "password.hash":{
            bsonType:"string",
            description:"Password.hash is required"
          },
          "password.salt":{
            bsonType:"string",
            description:"Password.salt is required"
          }
        }
      }
    }
  });

  await db.collection('users').createIndex({email:1}, {unique:true});

}
